function loadPlaylistsData(){var e=jsonData.loggedUserName.replace(/_/g,".");var t="https://techtime.accenture.com/mobile-playlist/"+e;$.ajax({type:"GET",url:t,dataType:"xml",success:getPlaylistsData,error:function(e,t,n){}})}function getPlaylistsData(e){$(e).find("playlist").each(function(e,t){var n=new Object;n.playlistId=$(this).attr("id");n.playlistName=$(this).attr("name");n.playlistType=$(this).attr("type");n.playlistItems=[];n.isUpdated=true;$(this).find("item").each(function(e,t){var r=new Object;r.playlistItemFormatType=$(this).find("format_type").text().substring(0,1);r.playlistItemContentType=$(this).find("content_type").text().substring(0,1);r.playlistItemId=r.playlistItemFormatType+"V"+$(this).find("id").text();r.playlistItemTitle=$(this).find("title").text();r.playlistItemDate=$(this).find("date").text();r.playlistItemAuthor=$(this).find("author").text();r.playlistItemUrl=$(this).find("url").text();r.playlistItemFormat=r.playlistItemUrl.substring(r.playlistItemUrl.lastIndexOf(".")+1,r.playlistItemUrl.length);r.playlistItemThumb=$(this).find("thumb").text();var i=new Object;i.itemId=r.playlistItemId.substring(2,r.playlistItemId.length);if(r.playlistItemId.substring(1,2)=="A"){i.mediaType="Audios"}else if(r.playlistItemId.substring(1,2)=="V"){i.mediaType="Videos"}else if(r.playlistItemId.substring(1,2)=="P"){i.mediaType="Panel Discussions"}else if(r.playlistItemId.substring(1,2)=="T"){i.mediaType="Technology Conferences"}else if(r.playlistItemId.substring(1,2)=="I"){i.mediaType="Interviews"}else if(r.playlistItemId.substring(1,2)=="D"){i.mediaType="documents"}i.thumbUrl=r.playlistItemThumb;playlistThumbnails.push(i);if(r.playlistItemFormat!="mp3"||r.playlistItemContentType!="d"){n.playlistItems.push(r)}});if(n.playlistItems.length>0){jsonData.playlists.push(n)}});if(isOnline){downloadPlaylistThumbnails()}}function displayPlaylist(){console.log(jsonData.playlists);var e="";var t="";$.each(jsonData.playlists,function(n,r){var i=r.playlistItems[r.playlistItems.length-1].playlistItemId.substr(2,r.playlistItems[r.playlistItems.length-1].playlistItemId.length);var s=r.playlistItems[r.playlistItems.length-1].playlistItemThumb;var o="";if(downloadedThumbs.indexOf(i+"thumb.png")!=-1){o=sPath+"/images/"+i+"thumb.png"}else if(downloadedThumbs.indexOf(i+"thumb.png")==-1){if(isOnline){o=s}else if(!isOnline){o=sPath+"/images/"+i+"thumb.png"}}t=r.playlistId;e=e+'<div id="'+r.playlistId+'" style="width:100%;background-color:#F0EFED;">';e=e+'<div style="width:13%;float:left;text-align:center;background-color:inherit;padding-top:12px;padding-bottom:12px;background-color:inherit;">';e=e+'<input id="playlist'+r.playlistId+'" data-playlistId="'+r.playlistId+'" data-playlistName="'+r.playlistName+'" type="checkbox" data-role="none" style="margin-top:7%;z-index:100;" onclick="selectPlaylistForSharing(this);"></div><div style="width:16%;min-width:75px;float:left;margin-top:7px;" onclick="displayPlaylistItems('+t+');gotFS(fileSystem)"><img src="'+o+'" style="max-height:75px;max-width:75px;width:100%;height:100%;"></img></div>';e=e+'<div style="width:54%;float:left;padding-top:12px;padding-bottom:12px;padding-left:5px;padding-right:5px;background-color:inherit;" onclick="displayPlaylistItems('+t+');gotFS(fileSystem)">';e=e+'<label style="font-size:16px;font-family:Lucida Grande, Lucida Sans Unicode, Lucida Sans, DejaVu Sans, Verdana, sans-serif;font-weight:bold;color:orange;whitespace:wrap" >'+r.playlistName+"</label>";e=e+'</div><div style="width:10%;padding-top:10px;padding-bottom:9px;float:left;text-align:right;background-color:inherit;" onclick="displayPlaylistItems('+t+');gotFS(fileSystem)">';if(r.playlistType=="admin"){e=e+'<img src="images/adminPlaylist.png" style="height:20px;width:20px;padding-right:30%;"><br/>'}else{e=e+"<br/>"}e=e+'<img src="images/orange_icon_right.png" style="height:20px;width:20px;padding-right:30%;"></div></div>';e=e+'<hr width="100%" color="#999999" style="margin-bottom:0px;"/>';i="";s="";o=""});$("#userPlaylistsDiv").html(e);showNavigateDiv("navigateDiv");$.mobile.changePage("#PlaylistsPage")}function displayPlaylistItems(e){playlistItemsPageFlag=false;var t="";var n="";var r="";var i="";myPlaylistItems=[];window.localStorage.setItem("lastOpenPlaylist",e);$("#userPlaylistsRenameOption").attr("data-playlistId",e);$.each(jsonData.playlists,function(s,o){if(e==o.playlistId){n=n+o.playlistName;if(o.playlistType=="admin"){$("#userPlaylistsRenameDeleteOption").css("display","none")}else{$("#userPlaylistsRenameDeleteOption").css("display","block")}n=o.playlistName;currentOpenPlaylist=e;if(o.playlistItems.length<=5){$("#playlistItemsLoadMoreDiv").css("display","none")}else if(o.playlistItems.length>5){$("#playlistItemsLoadMoreDiv").css("display","block")}$.each(o.playlistItems,function(e,n){i=n.playlistItemUrl.substr(n.playlistItemUrl.lastIndexOf(".")+1,n.playlistItemUrl.length);if(i=="mp3"){r="images/icon_audio.png"}else if(i=="mp4"){r="images/icon_video.png"}var s=new Object;s.id=n.playlistItemId;s.track=n.playlistItemTitle;if(entriesList.indexOf(n.playlistItemId)==-1){s.trackUrl=n.playlistItemUrl;s.isItemDownloaded=false}else if(entriesList.indexOf(n.playlistItemId)!=-1){s.trackUrl=sPath+n.playlistItemId+".mp4";s.isItemDownloaded=true}playlistArray.push(s);var u=n.playlistItemId.substr(2,n.playlistItemId.length);var a=n.playlistItemThumb;var f="";var l=n.playlistItemId;if(downloadedThumbs.indexOf(u+"thumb.png")!=-1){f=sPath+"/images/"+u+"thumb.png"}else if(downloadedThumbs.indexOf(u+"thumb.png")==-1){if(isOnline){f=a}else if(!isOnline){f="images/TechTime.png"}}var c="";var h=n.playlistItemAuthor.split("|");for(var p=0;p<h.length;p++){if(p<h.length-1){c=c+h[p]+", "}else{c=c+h[p]}}var d=new Object;d.itemId=n.playlistItemId;d.itemTitle=n.playlistItemTitle;d.thumnail=f;if(entriesList.indexOf(n.playlistItemId)==-1){d.itemPath=n.playlistItemUrl;d.isItemDownloaded=false}else if(entriesList.indexOf(n.playlistItemId)!=-1){d.itemPath=sPath+"/"+n.playlistItemId+".mp4";d.isItemDownloaded=true}myPlaylistItems.push(d);if(e<=playlistItemsEndIndex){t=t+'<div style="width:100%;background-color:#F0EFED;">';t=t+'<div onclick="playPlaylistItem(this)" id="playlistItem'+n.playlistItemId+'" data-playlistItemIndex="'+e+'" style="width:20%;float:left;padding-top:12px;padding-bottom:12px;padding-left:5px;padding-right:5px;background-color:#F0EFED;">';t=t+'<img src="'+f+'" style="max-height:65px;max-width:65px;width:100%;height:100%;padding-left:5%;margin-top:2%;"></img></div>';t=t+'<div onclick="playPlaylistItem(this)" id="playlistItem'+n.playlistItemId+'" data-playlistItemIndex="'+e+'" style="width:61%;float:left;padding-top:12px;padding-bottom:8px;padding-left:2px;padding-right:5px;background-color:#F0EFED;">';t=t+'<ul><li style="font-size:16px;font-family:Lucida Grande, Lucida Sans Unicode, Lucida Sans, DejaVu Sans, Verdana, sans-serif;list-style: none;" id="'+n.playlistItemId+'" title="'+n.playlistItemUrl+'">'+n.playlistItemTitle+"</li>";t=t+'<br/><label style="width:61%font-size:13px;font-family:Lucida Grande, Lucida Sans Unicode, Lucida Sans, DejaVu Sans, Verdana, sans-serif;color:orange;font-weight:100;">'+c+'</label><br/><label style="font-size:12px;font-family:Lucida Grande, Lucida Sans Unicode, Lucida Sans, DejaVu Sans, Verdana, sans-serif;color:black;font-weight:200;">'+n.playlistItemDate+"</label>";t=t+'</div></ul><div style="width:11%;height:100%;padding-top:10px;padding-bottom:9px;float:left;text-align:right;background-color:#F0EFED;">';t=t+'<img src="'+r+'" style="height:20px;width:20px;padding-right:10px;"><br/>';if(entriesList.indexOf(n.playlistItemId)==-1){t=t+'<img id="downloadPlItemBtn'+e+'" data-itemId="'+l+'" data-itemUrl="'+n.playlistItemUrl+'" data-itemTitle="'+n.playlistItemTitle+'" src="images/downloadPlaylistItem.png" style="height:32px;width:30px;padding-right:5px;padding-top:50%;z-index:999999" onclick="downloadPlaylistItem(this);">'}t=t+"</div>";t=t+'<hr width="100%" color="#999999" style="margin-bottom:0px;"/></div>'}if(playlistItemsEndIndex>=o.playlistItems.length-1){$("#playlistItemsLoadMoreDiv").css("display","none")}else if(playlistItemsEndIndex<o.playlistItems.length-1){$("#playlistItemsLoadMoreDiv").css("display","block")}})}});document.getElementById("userPlaylistsItemHeader").innerHTML=n;$("#userPlaylistsHeader").html(n);$("#playlistItemsDiv").html(t);$("#playlistItemsLoadMoreDiv").empty();var s="<div class='linkTransition' id='loadMorePlaylistItems' data-playlistId='"+e+"' data-itemStartIndex=0 data-itemEndIndex=4 style='height:30px;width:100%;background:#B3B3B3;text-align:center;color:white;padding-top:5px;font-size:16px;' title='5' onclick='loadMorePlaylistItems(this)'><b>Load More Playlist Items</b></div>";$("#playlistItemsLoadMoreDiv").html(s);if(!isActionLoadMoreResult){if(isOnline){var o='<video id="playlistItemPlayer" class="video-js vjs-default-skin" preload="none" style="width:100%;"  controls data-setup="{}"  src="'+myPlaylistItems[0].itemPath+'"></video>';$("#playlistItemPlayerDiv").html(o)}else if(!isOnline){if(myPlaylistItems[0].itemPath.indexOf("techtime.accenture")!=-1){if(myPlaylistItems[0].isItemDownloaded==false){var o='<video id="playlistItemPlayer" class="video-js vjs-default-skin" preload="none" style="width:100%;"  controls data-setup="{}"><source src="'+myPlaylistItems[0].itemPath+'" type="video/mp4"></video>'}}else if(myPlaylistItems[0].itemPath.indexOf("techtime.accenture")==-1){if(myPlaylistItems[0].isItemDownloaded==true){var o='<video id="playlistItemPlayer" type="video/mp4" style="width:100%;" src="'+myPlaylistItems[0].itemPath+'" controls></video>'}}$("#playlistItemPlayerDiv").html(o)}}document.getElementById("playlistItemPlayer").addEventListener("ended",autoplayNextItem,false);$("#nowPlayingItemTitle").html(myPlaylistItems[0].itemTitle);$.mobile.changePage("#playlistsItemPage")}function loadTrack(e){var t=e.title;var n=e.id;$("#PlaylistPlayer").attr("src",t);$.each(playlistArray,function(e,t){if(n==t.id){current=e;getVideo(playlistArray[e],play)}})}function playPlaylistItem(e){var t=$("#"+e.id);currentPlayingItemIndex=t.attr("data-playlistItemIndex");if(currentPlayingItemIndex===undefined){var n=myPlaylistItems.length-1;currentPlayingItemIndex=myPlaylistItems.length-1}else{var n=parseInt(currentPlayingItemIndex)}var r=myPlaylistItems[currentPlayingItemIndex].itemTitle;var i=myPlaylistItems[currentPlayingItemIndex].itemPath;var s=myPlaylistItems[currentPlayingItemIndex].thumnail;var o=myPlaylistItems[currentPlayingItemIndex].isItemDownloaded;var u=myPlaylistItems[currentPlayingItemIndex].itemId;if(isOnline&&(o==true||o=="true")){$("#playlistItemPlayer").attr("src",i);$("#playlistItemPlayer").attr("autoplay",true);$("#nowPlayingItemTitle").html(r);document.getElementById("playlistItemPlayer").play()}else if(isOnline&&(o==false||o=="false")){$("#playlistItemPlayer").attr("src",i);$("#playlistItemPlayer").attr("autoplay",true);$("#nowPlayingItemTitle").html(r);document.getElementById("playlistItemPlayer").play()}else if(!isOnline&&(o==true||o=="true")){$("#playlistItemPlayer").attr("src",i);$("#playlistItemPlayer").attr("autoplay",true);$("#nowPlayingItemTitle").html(r);document.getElementById("playlistItemPlayer").play()}else if(!isOnline&&(o==false||o=="false")){jAlert("Please go Online to view this Video.","Tech Time")}}function autoplayNextItem(e){var t=parseInt(currentPlayingItemIndex)+1;if(isOnline&&myPlaylistItems[t].isItemDownloaded==false){var n=new Object;n.id="playlistItem"+myPlaylistItems[t].itemId;if(t<=myPlaylistItems.length){playPlaylistItem(n)}}else if(isOnline&&myPlaylistItems[t].isItemDownloaded==true){var n=new Object;n.id="playlistItem"+myPlaylistItems[t].itemId;if(t<=myPlaylistItems.length){playPlaylistItem(n)}}else if(!isOnline&&myPlaylistItems[t].isItemDownloaded==false){jAlert("Please go online to stream this file.","Tech Time")}}function getVideo(e,t){function r(n){$("#PlaylistPlayer").off("canplay",r);e.isReady=true;if(typeof t==="function")t(e)}var n=this;$("#PlaylistPlayer").on("canplay",r,false);$("#PlaylistPlayer").src=e.trackUrl;$("#PlaylistPlayer")[0].play();$("#currentTrack").html(e.track)}function play(){var e=current;e++;if(e>playlistArray.length-1){}if(playlistArray.length>0){getVideo(playlistArray[e])}$("#PlaylistPlayer")[0].play();console.log(e+"***************************"+playlistArray.length);current=e}function downloadPlaylistThumbnails(){updateThumbnailList();var e=playlistThumbanails[playlistDownloadedThumbIndex].itemId;var t=playlistThumbanails[playlistDownloadedThumbIndex].thumbUrl;var n=playlistThumbanails[playlistDownloadedThumbIndex].mediaType;numberOfThumbsToDownload=playlistThumbanails.length;if(playlistDownloadedThumbIndex<numberOfThumbsToDownload){downloadPlaylistThumbImages(e,"thumb",t,n)}}function downloadPlaylistThumbImages(e,t,n,r){var i="";i=n;var s="";s=t;var o="";o="false";var u="";u="";if(downloadedThumbs.indexOf(playlistThumbanails[playlistDownloadedThumbIndex].itemId+"thumb.png")==-1){var a=new FileTransfer;if(isOnline){u=sPath+"images/"+e+t+".png";if(i!=""){a.download(i,u,function(e){playlistDownloadedThumbIndex=playlistDownloadedThumbIndex+1;if(playlistDownloadedThumbIndex<numberOfThumbsToDownload){downloadPlaylistThumbnails()}},function(e){console.log("download error source "+e)})}}}else{playlistDownloadedThumbIndex=playlistDownloadedThumbIndex+1;if(playlistDownloadedThumbIndex<numberOfThumbsToDownload){downloadPlaylistThumbnails()}}}function downloadPlaylistItem(e){playlistItemsPageFlag=true;var t="";var n="";var r="";var i=$("#"+e.id);t=i.attr("data-itemId");n=i.attr("data-itemUrl");r=i.attr("data-itemTitle");t=t.replace(/[^a-zA-Z0-9]/g,"");downloadFile(t,n,false,r,2)}function showRenamePlaylistForm(){$("#userPlaylistsRenameDeleteOption").css("display","none");$("#renamePlaylistNoName").css("display","none");$("#renamePlaylistNoInternet").css("display","none");$("#renamePlaylistForm").css("display","block");$("#renamePlaylistNamePlaceholder").val($("#userPlaylistsItemHeader").text());showHideVideoPlayer("hide")}function cancelRenamePlaylistAction(){$("#renamePlaylistForm").css("display","none");$("#renamePlaylistNoName").css("display","none");$("#renamePlaylistNoInternet").css("display","none");$("#userPlaylistsRenameDeleteOption").css("display","block");showHideVideoPlayer("show")}function renamePlaylist(){var e="https://techtime.accenture.com/techtimemobile/playlist-service";var t=$("#renamePlaylistNamePlaceholder").val();t=t.replace(/[^a-zA-Z0-9 ]/g,"");var n=false;var r=jsonData.loggedUserName.replace(/_/g,".");$.each(jsonData.playlists,function(e,r){if(r.playlistName==t){n=true}});if(isOnline&&!n){if(t!=""){var i='{"data":{"mode":"rename","username":"'+r+'","playlistIds":"'+currentOpenPlaylist+'","renamedPlaylist":"'+t+'"}}';$.ajax({type:"POST",url:e,data:i,dataType:"xml",contentType:"application/json",success:function(e){$("#renamePlaylistForm").css("display","none");$("#userPlaylistsRenameDeleteOption").css("display","block");$("#userPlaylistsItemHeader").html(t);updatePlaylistNameInJson(currentOpenPlaylist,t);showHideVideoPlayer("show")},error:function(e,t,n){console.log("In Failure"+JSON.stringify(e));jAlert("Oops! There was some error renaming your Playlist. Please try again.","Tech Time")}})}else{$("#renamePlaylistForm").css("display","none");$("#renamePlaylistNoName").css("display","block")}}else if(!isOnline){$("#renamePlaylistForm").css("display","none");$("#renamePlaylistNoName").css("display","none");$("#renamePlaylistNoInternet").css("display","block")}else if(n){jAlert("Playlist with this name already exists. Please choose a different name.","Tech Time");n=false}}function updatePlaylistNameInJson(e,t){$.each(jsonData.playlists,function(n,r){if(r.playlistId==e){r.playlistName=t}});getFileSystemRefForWriting(jsonData)}function showDeletePlaylistConfirmation(){$("#deletePlaylistConfirmation").css("display","block");$("#deletePlaylistConfirmationLabel").text("Are you sure you want to delete "+$("#userPlaylistsItemHeader").text()+"?");$("#userPlaylistsRenameDeleteOption").css("display","none");showHideVideoPlayer("hide")}function cancelDeletePlaylistAction(){$("#deletePlaylistConfirmation").css("display","none");$("#deletePlaylistNoInternet").css("display","none");$("#userPlaylistsRenameDeleteOption").css("display","block");showHideVideoPlayer("show")}function deletePlaylist(){var e="https://techtime.accenture.com/techtimemobile/playlist-service";var t=jsonData.loggedUserName.replace(/_/g,".");if(isOnline){var n='{"data":{"mode":"delete","username":"'+t+'","playlistIds":"'+currentOpenPlaylist+'"}}';$.ajax({type:"POST",url:e,data:n,dataType:"xml",contentType:"application/json",success:function(e){$("#deletePlaylistConfirmation").css("display","none");$("#userPlaylistsRenameDeleteOption").css("display","block");console.log("file deleted successfully");updatePlaylistsInJsonAfterDeletePlaylist(currentOpenPlaylist)},error:function(e,t,n){console.log("In Failure"+JSON.stringify(e));jAlert("Oops! There was some error deleting your Playlist. Please try again.","Tech Time")}})}else if(!isOnline){jsonData.deletedPlaylistIds.push(currentOpenPlaylist);updatePlaylistsInJsonAfterDeletePlaylist(currentOpenPlaylist);cancelDeletePlaylistAction()}}function updatePlaylistsInJsonAfterDeletePlaylist(e){var t;$.each(jsonData.playlists,function(n,r){if(r.playlistId==e){t=n}});if(t!=null){if(~t)jsonData.playlists.splice(t,1)}resetPlaylistLMRParameters();displayPlaylist();$.mobile.changePage("#PlaylistsPage");getFileSystemRefForWriting(jsonData)}function showCreateNewPlaylistForm(){$("#newPlaylistNamePlaceholder").attr("placeholder","New Playlist Name");$("#createNewPlaylistForm").css("display","block");$("#createNewPlaylistTab").css("display","none");$("#createPLNoName").css("display","none")}function cancelNewPlaylistCreation(){$("#createNewPlaylistTab").css("display","block");$("#createNewPlaylistForm").css("display","none");$("#createPLNoInternet").css("display","none");$("#createPLNoName").css("display","none")}function createNewPlaylist(){var e="https://techtime.accenture.com/techtimemobile/playlist-service";var t=$("#newPlaylistNamePlaceholder").val();var n=false;t=t.replace(/[^a-zA-Z0-9 ]/g,"");var r=jsonData.loggedUserName.replace(/_/g,".");$.each(jsonData.playlists,function(e,r){if(r.playlistName==t){n=true}});if(isOnline&&!n){if(t!=""){var i='{"data" :{"mode" : "create","username":"'+r+'","playlistName":"'+t+'"}}';$.ajax({type:"POST",url:e,data:i,dataType:"xml",contentType:"application/json",success:function(e){var n=$(e).find("result");var r=$(n).find("item");var i=$(r).find("id");var s=i.text();$("#createNewPlaylistForm").css("display","none");$("#createNewPlaylistTab").css("display","block");addPlaylistDetailsToJsonAfterCreation(t,s)},error:function(e,t,n){console.log("In Failure"+JSON.stringify(e));jAlert("Oops! There was some error creating your Playlist. Please try again.","Tech Time")}})}else{$("#createNewPlaylistForm").css("display","none");$("#createPLNoName").css("display","block")}}else if(!isOnline){$("#createNewPlaylistForm").css("display","none");$("#createPLNoInternet").css("display","block")}else if(n){jAlert("Playlist with this name already exists. Please choose a different name.","Tech Time");n=false}}function getAddToPlaylistItemDetails(e){playlistItemToBeAdded=new Object;playlistItemToBeAdded.playlistItemId=$("#"+e.id).attr("data-playlistItemId");playlistItemToBeAdded.playlistItemTitle=$("#"+e.id).attr("data-playlistItemTitle");playlistItemToBeAdded.playlistItemDate=$("#"+e.id).attr("data-playlistItemDate");playlistItemToBeAdded.playlistItemAuthor=$("#"+e.id).attr("data-playlistItemAuthor");playlistItemToBeAdded.playlistItemUrl=$("#"+e.id).attr("data-playlistItemUrl");playlistItemToBeAdded.playlistItemThumb=$("#"+e.id).attr("data-playlistItemThumb");addedItemName=playlistItemToBeAdded.playlistItemTitle}function addPlaylistDetailsToJsonAfterCreation(e,t){var n=new Object;n.playlistId=t;n.playlistName=e;n.playlistType="normal";n.playlistItems=[];n.playlistItems.push(playlistItemToBeAdded);addedItemToPlaylistName=e;if(isOnline){n.isUpdated=true}else!isOnline;{n.isUpdated=false}jsonData.playlists.push(n);$.mobile.changePage("#detailMediaPage");if(isOnline){updateAddedItemOnServer(t,playlistItemToBeAdded.playlistItemId.substring(2,playlistItemToBeAdded.playlistItemId.length-1))}getFileSystemRefForWriting(jsonData)}function addItemToSelectedPlaylist(e){if(isOnline){$.each(jsonData.playlists,function(t,n){if(n.playlistId==e){var r=false;var i=false;if(n.playlistType=="admin"){i=true}$.each(n.playlistItems,function(e,t){if(t.playlistItemId==playlistItemToBeAdded.playlistItemId){r=true}});if(r==false&&i==false){addedItemToPlaylistName=n.playlistName;n.playlistItems.push(playlistItemToBeAdded);$.mobile.changePage("#detailMediaPage");if(isOnline){updateAddedItemOnServer(e,playlistItemToBeAdded.playlistItemId.substring(2,playlistItemToBeAdded.playlistItemId.length-1))}if(!isOnline){n.isUpdated=false}getFileSystemRefForWriting(jsonData)}else if(r==true&&i==false){jAlert("Item already exists in this playlist.","Tech Time")}else if(r==true&&i==true){jAlert("You cannot add items to an Admin Playlist. Item already exists in this playlist.","Tech Time")}else if(r==false&&i==true){jAlert("You cannot add items to an Admin Playlist.","Tech Time")}}})}else if(!isOnline){jAlert("Please go Online to add selected Item to this Playlist.","Tech Time")}console.log("jsondata playlist : "+jsonData.playlists)}function updateAddedItemOnServer(e,t){var n=e;var r=t;var i="https://techtime.accenture.com/techtimemobile/playlist-items-service";var s=jsonData.loggedUserName.replace(/_/g,".");if(isOnline){var o='{"data":{"mode":"addItem","username":"'+s+'","playlistIds":"'+n+'","itemId":"'+r+'"}}';$.ajax({type:"POST",url:i,data:o,dataType:"xml",contentType:"application/json",success:function(e){console.log("Added Item "+r+" to Playlist Id "+n);getFileSystemRefForWriting(jsonData);jAlert('"'+addedItemName+'" is added to playlist "'+addedItemToPlaylistName+'".',"Tech Time")},error:function(e,t,n){console.log("In Failure"+JSON.stringify(e));jAlert("Oops! There was some error creating your Playlist. Please try again.","Tech Time")}})}}function selectPlaylistForSharing(e){var t=new Object;t.selectedPlaylistId=$("#"+e.id).attr("data-playlistId");t.selectedPlaylistName=$("#"+e.id).attr("data-playlistName");if(e.checked){selectedPlaylistsToShare.push(t)}else{selectedPlaylistsToShare.splice(t)}}function displaySharePlaylistPage(){$("#sharedPlaylistsNames").empty();if(selectedPlaylistsToShare.length>0&&isOnline){var e="";$("#sharePlaylistHeaderText").html("");if(selectedPlaylistsToShare.length==1){$("#sharePlaylistHeaderText").html("Playlist you have selected to Share:");$("#sharePlaylistBtn").attr("src","images/sharePlaylistBtn.png")}else if(selectedPlaylistsToShare.length>1){$("#sharePlaylistHeaderText").html("Playlists you have selected to Share:");$("#sharePlaylistBtn").attr("src","images/sharePlaylistsBtn.png")}$.each(selectedPlaylistsToShare,function(t,n){e+='<label id="myPlayList" style="padding-left:10px;color:#000;font-family:Gotham, Helvetica, Arial, sans-serif;font-size:16px;font-weight:bold;">'+n.selectedPlaylistName+"</label><br/>"});e+='<hr width="100%" size="1" style="padding-left:10px;">';$("#sharedPlaylistsNames").html(e);resetSharePlaylistForm();$.mobile.changePage("#sharePlaylistsPage")}else if(selectedPlaylistsToShare.length==0&&isOnline){jAlert("Please select a playlist to Share.","Tech Time")}else if(!isOnline){jAlert("Please check your internet connection or Go Online to share Playlists.","Tech Time")}}function addEmailField(){currentIndexPL=currentIndexPL+1;var e="";e+='<div id="inputMailFormDiv'+currentIndexPL+'" style="width:75%;float:left;padding-left:2%;margin-bottom:10px">';e+='<input id="playlistRecepient'+currentIndexPL+'" type="text" class="recepientMailAddress" placeholder="Enter Accenture Mail ID" name="email" id="email" style="width:95%;margin:auto;text-indent:3px;" onfocus="appendEmailDomain(this);">';e+='</div><div id="inputMailAddRemoveDiv'+currentIndexPL+'" style="width:17%;float:right">';e+='<img id="removeEmailFieldButton'+currentIndexPL+'" src="images/removeOption.png" style="height:24px;width:24px;" onClick="removeEmailField(this)"></img>';e+='<img id="addEmailFieldButton'+currentIndexPL+'" src="images/addOption.png" style="height:24px;width:24px;" onClick="addEmailField(this)"></img>';e+="</div>";$("#shareWithInputForm").append(e);$("#playlistRecepient"+currentIndexPL).textinput().textinput("refresh");e=""}function removeEmailField(e){var t=e.id.split("removeEmailFieldButton");var n=t[1];$("#inputMailFormDiv"+n).remove();$("#addEmailFieldButton"+n).remove();$("#removeEmailFieldButton"+n).remove();$("#playlistRecepient"+n).remove();$("#inputMailAddRemoveDiv"+n).remove()}function generateSharePlaylistRecepientsList(){var e=false;var t=$(".recepientMailAddress");var n=jsonData.loggedUserName.replace(/_/g,".");sharePlaylistJSON='{"data":{"mode":"share","username":"'+n+'","playlistIds":"';for(var r=0;r<selectedPlaylistsToShare.length;r++){if(r<selectedPlaylistsToShare.length-1){sharePlaylistJSON+=selectedPlaylistsToShare[r].selectedPlaylistId+","}else{sharePlaylistJSON+=selectedPlaylistsToShare[r].selectedPlaylistId+'",'}}sharePlaylistJSON+='"recepients":"';$(".recepientMailAddress").each(function(t,n){var r=$(this).val();if((r!=""||r=="@accenture.com")&&(r==""||r!="@accenture.com")){if(r.indexOf("@accenture.com")==-1){e=false}}if(t<$(".recepientMailAddress").length-1){if(r!=""){if(r!="@accenture.com"){sharePlaylistJSON+=r.replace("@accenture.com","").toLowerCase()+","}}}else{if(r!=""){if(r!="@accenture.com"){sharePlaylistJSON+=r.replace("@accenture.com","").toLowerCase()}}}if(r.replace("@accenture.com","")!=""){e=true}});sharePlaylistJSON+='"}}';if(e){sharePlaylistsToRecepients(sharePlaylistJSON)}else{jAlert("Please enter the Email address to share the selected Playlists.","Tech Time")}}function sharePlaylistsToRecepients(e){var t="https://techtime.accenture.com/techtimemobile/playlist-service";if(isOnline){var n=e;$.ajax({type:"POST",url:t,data:n,dataType:"xml",contentType:"application/json",success:function(e){if(selectedPlaylistsToShare.length>1){jAlert("Email sent successfully.","Tech Time")}else if(selectedPlaylistsToShare.length==1){jAlert("Email sent successfully.","Tech Time")}resetSharePlaylistForm();resetSharePlaylistParameters();resetPlaylistLMRParameters();displayPlaylist()},error:function(e,t,n){console.log("In Failure"+JSON.stringify(e));if(selectedPlaylistsToShare.length>1){jAlert("Oops! There was some error sharing your Playlists. Please try again.","Tech Time")}else if(selectedPlaylistsToShare.length==1){jAlert("Oops! There was some error sharing your Playlist. Please try again.","Tech Time")}}})}else if(!isOnline){if(selectedPlaylistsToShare.length>1){jAlert("Please check your internet connection or Go Online to share your Playlists.","Tech Time")}else if(selectedPlaylistsToShare.length==1){jAlert("Please check your internet connection or Go Online to share your Playlist.","Tech Time")}}}function appendEmailDomain(e){if($("#"+e.id).val()=="@accenture.com"||$("#"+e.id).val()==""){$("#"+e.id).val("@accenture.com");$("#"+e.id).prop("selectionStart",0).prop("selectionEnd",10)}}function resetSharePlaylistForm(){var e=$("input[id^='playlistRecepient']");var t=$("div[id^='inputMailFormDiv']");var n=$("div[id^='inputMailAddRemoveDiv']");$.each(e,function(){$(this).val("")});$.each(t,function(e){if(e>2){$(this).remove()}});$.each(n,function(e){$(this).remove()})}function resetSharePlaylistParameters(){sharePlaylistJSON="";selectedPlaylistsToShare=[];$("#sharedPlaylistsNames").empty()}function showAddToPlaylist(){cancelNewPlaylistCreation();var e="";var t="";e=e+'<hr width="100%" color="#999999" style="margin-bottom:0px;"/>';$.each(jsonData.playlists,function(n,r){var i=r.playlistItems[r.playlistItems.length-1].playlistItemId.substr(2,r.playlistItems[r.playlistItems.length-1].playlistItemId.length);var s=r.playlistItems[r.playlistItems.length-1].playlistItemThumb;var o="";if(downloadedThumbs.indexOf(i+"thumb.png")!=-1){o=sPath+"/images/"+i+"thumb.png"}else if(downloadedThumbs.indexOf(i+"thumb.png")==-1){if(isOnline){o=s}else if(!isOnline){o="images/TechTime.png"}}t=r.playlistId;e=e+'<div id="'+r.playlistId+'" style="width:100%;background-color:#F0EFED;" onclick="addItemToSelectedPlaylist('+r.playlistId+')">';e=e+'<div style="width:2%;float:left;text-align:center;background-color:inherit;padding-top:12px;padding-bottom:12px;background-color:#F0EFED;">';e=e+'</div><div style="width:16%;float:left;margin-top:7px;"><img src="'+o+'" style="max-height:75px;max-width:75px;width:100%;height:100%;"></img></div>';e=e+'<div style="width:68%;float:left;padding-top:12px;padding-bottom:12px;padding-left:5px;padding-right:5px;background-color:#F0EFED;">';e=e+'<label style="font-size:16px;font-family:Lucida Grande, Lucida Sans Unicode, Lucida Sans, DejaVu Sans, Verdana, sans-serif;font-weight:bold;color:orange;" >'+r.playlistName+"</label>";e=e+'</div><div style="width:10%;padding-top:10px;padding-bottom:9px;float:left;text-align:right;background-color:#F0EFED;">';if(r.playlistType=="admin"){e=e+'<img src="images/adminPlaylist.png" style="height:20px;width:20px;"><br/>'}else{e=e+"<br/>"}e=e+'<img src="images/orange_icon_right.png" style="height:20px;width:20px;"></div></div>';e=e+'<hr width="100%" color="#999999" style="margin-bottom:0px;"/>';i="";s="";o=""});$("#listOfPlaylists").html(e);$.mobile.changePage("#addToPlaylistPage")}function loadMorePlaylistItems(e){isActionLoadMoreResult=true;playlistItemsStartIndex+=5;playlistItemsEndIndex+=5;var t=$("#"+e.id).attr("data-playlistId");displayPlaylistItems(t)}function resetPlaylistLMRParameters(){playlistItemsStartIndex=0;playlistItemsEndIndex=4;isActionLoadMoreResult=false}function showHideVideoPlayer(e){if(e=="hide"){document.getElementById("playlistItemPlayer").pause();$("#playlistItemPlayer").css("display","none")}else if(e=="show"){document.getElementById("playlistItemPlayer").play();$("#playlistItemPlayer").css("display","block")}}var playlistArray=new Array;var playlistThumbanails=[];var playing=false;var current=0,isPlaying=false;var playlistDownloadedThumbIndex=0;var playlistThumbnails=[];var myPlaylistItems=[];var playlistItemsStartIndex=0;var playlistItemsEndIndex=4;var isActionLoadMoreResult=false;var video1=document.getElementById("PlaylistPlayer");var currentPlayingItemIndex=0;var currentOpenPlaylist="";var playlistItemToBeAdded=new Object;var addedItemName="";var addedItemToPlaylistName="";var sharePlaylistJson='{"data":{"mode":"share","username":"ankit.bharat.tanna","playlistIds":"';var selectedPlaylistsToShare=[];var currentIndexPL=3;var sharePlaylistJSON=""